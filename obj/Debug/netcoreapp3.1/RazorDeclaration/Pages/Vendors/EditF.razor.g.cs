// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace Tamin.Pages.Vendors
{
    #line hidden
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 1 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 2 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Microsoft.AspNetCore.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Microsoft.AspNetCore.Components.Authorization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Microsoft.AspNetCore.Identity;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Tamin;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Tamin.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Entities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using System.Linq.Dynamic;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Telerik.Blazor;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Telerik.Blazor.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "D:\Programming\Tamin-New\Pages\_Imports.razor"
using Telerik.Documents;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Windows.Documents.Spreadsheet.FormatProviders;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Windows.Documents.Spreadsheet.FormatProviders.OpenXml.Xlsx;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Windows.Documents.Spreadsheet.Model;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using System.Collections;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using System;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using System.Collections.Generic;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Windows.Documents.Spreadsheet.FormatProviders.Pdf;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Windows.Documents.Spreadsheet.FormatProviders.TextBased.Csv;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Windows.Documents.Spreadsheet.FormatProviders.TextBased.Txt;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Windows.Documents.Spreadsheet.Utilities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using System.Linq;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.Documents.Common.Model;

#line default
#line hidden
#nullable disable
#nullable restore
#line 16 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using System.Collections.ObjectModel;

#line default
#line hidden
#nullable disable
#nullable restore
#line 17 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Tamin.DocumentProcessing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 18 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.DataSource;

#line default
#line hidden
#nullable disable
#nullable restore
#line 19 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Telerik.DataSource.Extensions;

#line default
#line hidden
#nullable disable
#nullable restore
#line 20 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Tamin.Data;

#line default
#line hidden
#nullable disable
#nullable restore
#line 21 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
using Tamin.Data.Models;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/EditForm")]
    public partial class EditF : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 511 "D:\Programming\Tamin-New\Pages\Vendors\EditF.razor"
       

    public IEnumerable<VendorInPut> GridData = new List<VendorInPut>();
    public IEnumerable<VendorInPut> Userdata = new List<VendorInPut>();
    public IEnumerable<VendorInPut> vendorselected = new List<VendorInPut>();
    public List<Projects> GridPJ = new List<Projects>();
    public List<ActivityOutPut> GridAT = new List<ActivityOutPut>();
    public List<Groups> GridGP = new List<Groups>();
    public List<string> project = new List<string>();
    public List<string> activity = new List<string>();
    private VendorInPut Vendors = new VendorInPut();

    public string group { get; set; }
    bool ExportAllPages { get; set; }
    public bool DeleteConfirm { get; set; }
    public bool isVisible { get; set; }
    public bool isVisible2 { get; set; }
    public bool isVisible3 { get; set; }
    public bool isVisible4 { get; set; }
    public bool isVisible5 { get; set; }

    List<VendorInPut> GetLevelData(int Id)
    {
        return GridData.Where(itm => itm.Id == Id).ToList();
    }

    GridSelectionMode selectionMode { get; set; } = GridSelectionMode.Multiple;

    bool ShowSelectAll
        => selectionMode == GridSelectionMode.Multiple;

    protected override async Task OnInitializedAsync()

    {
        await LoadData();
        await CurrentUser();
    }

    async Task LoadData()
    {

        var vendors = await _dbVendorData.GetVendors();
        GridData = new ObservableCollection<VendorInPut>(vendors);
        GridPJ = await _dbProjectsData.GetProjects();
        GridAT = await _dbActivityData.GetActivity();
        GridGP = await _dbGroupsData.GetGroup();

    }

    async Task OnStateInitHandler(GridStateEventArgs<VendorInPut> args)
    {
        var state = new GridState<VendorInPut>
        {
            SortDescriptors = new List<Telerik.DataSource.SortDescriptor>
{
                new Telerik.DataSource.SortDescriptor{ Member = "Date", SortDirection = Telerik.DataSource.ListSortDirection.Descending }
            },

        };

        args.GridState = state;
        await LoadData();
    }
    public async Task CurrentUser()
    {
        var authState = await AuthenticationStateProvider.GetAuthenticationStateAsync();
        var user = authState.User;
        var currentUser = await UserManager.GetUserAsync(user);
        Userdata = GridData.Where(u => u.EMail == currentUser.Email);

    }

    void EditHandler(GridCommandEventArgs args)
    {

        VendorInPut item = (VendorInPut)args.Item;
        var a = string.Join(" , ", activity.ToList());
        var p = string.Join(" , ", project.ToList());
        var g = group;

        if (a != "")
        {
            Vendors.Activities = a;
            item.Activities = Vendors.Activities;
        }
        if (p != "")
        {
            Vendors.Projects = p;
            item.Projects = Vendors.Projects;
        }

        if (g != null)
        {
            Vendors.Groups = g;
            item.Groups = Vendors.Groups;
        }


        DateTime dateAndTime = DateTime.Now;
        item.EditDate = (dateAndTime.ToString("yyyy/MM/dd"));

    }


    async Task UpdateHandler(GridCommandEventArgs args)
    {
        await LoadData();
        await CurrentUser();
        StateHasChanged();
        VendorInPut item = (VendorInPut)args.Item;
        var a = string.Join(" , ", activity.ToList());
        var p = string.Join(" , ", project.ToList());
        var g = group;

        if (a != "")
        {
            Vendors.Activities = a;
            item.Activities = Vendors.Activities;
        }
        if (p != "")
        {
            Vendors.Projects = p;
            item.Projects = Vendors.Projects;
        }

        if (g != null)
        {
            Vendors.Groups = g;
            item.Groups = Vendors.Groups;
        }

        DateTime dateAndTime = DateTime.Now;
        item.EditDate = (dateAndTime.ToString("yyyy/MM/dd"));
        await _dbVendorData.UpdateVendors(item);

        await LoadData();
        await CurrentUser();

        isVisible2 = true;
        StateHasChanged();
        await Task.Delay(2000);

        isVisible2 = false;
        StateHasChanged();

    }


    public async Task DeleteHandler(GridCommandEventArgs args)

    {

        await ShowWindow();

        await Task.Delay(4000);

        StateHasChanged();

        if (DeleteConfirm)
        {
            VendorInPut item = (VendorInPut)args.Item;
            await _dbVendorData.DeleteVendores(item);
        }

        DeleteConfirm = false;



        await LoadData();
    }

    async Task CreateHandler(GridCommandEventArgs args)
    {

        VendorInPut item = (VendorInPut)args.Item;
        item.Projects = Vendors.Projects;
        item.Activities = Vendors.Activities;
        item.Groups = Vendors.Groups;
        DateTime dateAndTime = DateTime.Now;
        item.EditDate = (dateAndTime.ToString("yyyy/MM/dd"));
        var r = GridData.Where(x => x.Name == item.Name).Select(y => y.Name).ElementAtOrDefault(0);
        var e = GridData.Where(y => y.EMail == item.EMail).Select(x => x.EMail).ElementAtOrDefault(0);
        var c = GridData.Where(y => y.EconomicCode == item.EconomicCode).Select(x => x.EconomicCode).ElementAtOrDefault(0);
        var n = GridData.Where(y => y.RegistrationNo == item.RegistrationNo).Select(x => x.RegistrationNo).ElementAtOrDefault(0);
        var p = GridData.Where(y => y.PostalCode == item.PostalCode).Select(x => x.PostalCode).ElementAtOrDefault(0);
        var w = GridData.Where(y => y.WebSite == item.WebSite).Select(x => x.WebSite).ElementAtOrDefault(0);
        var i = GridData.Where(y => y.NatioalId == item.NatioalId).Select(x => x.NatioalId).ElementAtOrDefault(0);
        if (r != null || e != null || c != null || n != null || p != null || w != null || i != null)
        {
            isVisible4 = true;
        }
        else
        {
            await _dbVendorData.InsertVendors(item);

            StateHasChanged();
            await LoadData();


            isVisible3 = true;
            StateHasChanged();
            await Task.Delay(2000);

            isVisible3 = false;
            StateHasChanged();
        }


    }

    async Task CancelHandler(GridCommandEventArgs args)
    {

        VendorInPut item = (VendorInPut)args.Item;

        await LoadData();
    }

    async Task SelectRefresh(GridCommandEventArgs args)
    {
        vendorselected = Enumerable.Empty<VendorInPut>();

        await LoadData();
    }

    public async Task ShowWindow()
    {
        isVisible = true;

        await LoadData();
        StateHasChanged();
    }

    public async Task Confirm()
    {
        DeleteConfirm = true;
        isVisible = false;

        await LoadData();
        StateHasChanged();
    }

    public async Task CloseWindow()
    {
        DeleteConfirm = false;
        isVisible = false;

        await LoadData();
        StateHasChanged();
    }


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager NavigationManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IAssessmentSSData _dbAssessmentSSData { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IAssessmentSCData _dbAssessmentSCData { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IAssessmentFSData _dbAssessmentFSData { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IAssessmentFCData _dbAssessmentFCData { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IGroupsData _dbGroupsData { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IActivityData _dbActivityData { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IVendorData _dbVendorData { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private UserManager<IdentityUser> UserManager { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private AuthenticationStateProvider AuthenticationStateProvider { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JsRuntime { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IProjectsData _dbProjectsData { get; set; }
    }
}
#pragma warning restore 1591
